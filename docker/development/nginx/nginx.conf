server {
	listen [::]:80 default_server;
	listen 80 default_server;
    server_name  _;

    root /var/www/public;

    index index.php index.html index.htm;

    charset utf-8;

    keepalive_timeout 20s;

    #client_max_body_size 108M;

    access_log  /var/www/logs/nginx/access.log;
    error_log  /var/www/logs/nginx/error.log;

    # NOTE: configurar de acordo com o projeto
    # error_page 400 401 403 404 405 408 409 410 411 412 413 414 415 416 417 418 421 422 423 424 426 428 429 431 451 500 501 502 503 504 505 506 507 508 510 511 /error/$status;

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    location / {
        try_files $uri $uri/ /index.php$is_args$args;
    }

    location ~ \.php$ {
        fastcgi_pass   php-fpm:9000;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  $realpath_root$fastcgi_script_name;
        # TODO: estudar diretivas melhor
        fastcgi_buffers 16 16k;
        fastcgi_buffer_size 32k;
        include        /etc/nginx/fastcgi_params;
        # NOTE: para essa diretiva funcionar a diretiva error_page deve estar configurada
        # fastcgi_intercept_errors on;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}
